{"version":3,"file":"ResetPassword-f817bc0d.js","sources":["../../src/views/auth/ResetPassword.vue"],"sourcesContent":["<template>\n  <div class=\"reset-password-page min-h-screen bg-gray-100 py-12 px-4 flex items-center justify-center\">\n    <div class=\"max-w-md w-full bg-white p-8 rounded-lg shadow-md\">\n      <div class=\"text-center mb-6\">\n        <h2 class=\"text-2xl font-bold text-gray-800\">重置密码</h2>\n        <p class=\"text-gray-600 mt-2\">请设置您的新密码</p>\n      </div>\n      \n      <el-form\n        ref=\"resetFormRef\"\n        :model=\"formData\"\n        :rules=\"formRules\"\n        @submit.prevent=\"handleSubmit\"\n      >\n        <el-form-item prop=\"password\">\n          <el-input\n            v-model=\"formData.password\"\n            placeholder=\"新密码\"\n            type=\"password\"\n            prefix-icon=\"Lock\"\n            autocomplete=\"new-password\"\n            show-password\n          />\n          <div class=\"text-xs text-gray-500 mt-1 ml-1\">\n            密码长度不能小于6个字符\n          </div>\n        </el-form-item>\n        \n        <el-form-item prop=\"confirmPassword\">\n          <el-input\n            v-model=\"formData.confirmPassword\"\n            placeholder=\"确认密码\"\n            type=\"password\"\n            prefix-icon=\"Lock\"\n            autocomplete=\"new-password\"\n            show-password\n          />\n        </el-form-item>\n        \n        <el-button\n          type=\"primary\"\n          native-type=\"submit\"\n          class=\"w-full mt-4\"\n          :loading=\"loading\"\n        >\n          重置密码\n        </el-button>\n      </el-form>\n      \n      <div v-if=\"errorMessage\" class=\"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n        {{ errorMessage }}\n      </div>\n      \n      <div v-if=\"successMessage\" class=\"mt-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded\">\n        {{ successMessage }}\n        <div class=\"mt-2\">\n          <router-link to=\"/auth/login\" class=\"text-green-700 font-semibold underline\">\n            立即登录\n          </router-link>\n        </div>\n      </div>\n      \n      <div class=\"mt-6 text-center\" v-if=\"!successMessage\">\n        <router-link to=\"/auth/login\" class=\"text-blue-600 hover:text-blue-800\">\n          返回登录\n        </router-link>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { Lock } from '@element-plus/icons-vue';\nimport { ElMessage } from 'element-plus';\nimport { userApi } from '@/api/user';\n\nconst route = useRoute();\nconst router = useRouter();\n\nconst formData = reactive({\n  password: '',\n  confirmPassword: '',\n  token: ''\n});\n\n// 密码验证函数\nconst validatePassword = (rule, value, callback) => {\n  if (value === '') {\n    callback(new Error('请输入密码'));\n  } else if (value.length < 6) {\n    callback(new Error('密码长度不能小于6个字符'));\n  } else {\n    if (formData.confirmPassword !== '') {\n      resetFormRef.value.validateField('confirmPassword');\n    }\n    callback();\n  }\n};\n\n// 确认密码验证函数\nconst validateConfirmPassword = (rule, value, callback) => {\n  if (value === '') {\n    callback(new Error('请再次输入密码'));\n  } else if (value !== formData.password) {\n    callback(new Error('两次输入密码不一致'));\n  } else {\n    callback();\n  }\n};\n\nconst formRules = {\n  password: [\n    { validator: validatePassword, trigger: 'blur' }\n  ],\n  confirmPassword: [\n    { validator: validateConfirmPassword, trigger: 'blur' }\n  ]\n};\n\nconst loading = ref(false);\nconst errorMessage = ref('');\nconst successMessage = ref('');\nconst resetFormRef = ref(null);\nconst tokenValid = ref(false);\n\nonMounted(() => {\n  // 从路由获取令牌\n  const token = route.params.token || route.query.token;\n  \n  if (!token) {\n    errorMessage.value = '重置令牌不存在，请重新申请找回密码';\n    return;\n  }\n  \n  formData.token = token;\n  tokenValid.value = true;\n});\n\nconst handleSubmit = () => {\n  if (!tokenValid.value) {\n    errorMessage.value = '重置令牌无效，请重新申请找回密码';\n    return;\n  }\n  \n  resetFormRef.value.validate(async (valid) => {\n    if (!valid) return;\n    \n    loading.value = true;\n    errorMessage.value = '';\n    successMessage.value = '';\n    \n    try {\n      const response = await userApi.resetPassword(formData.token, formData.password);\n      successMessage.value = response.data.message || '密码重置成功，请使用新密码登录';\n      \n      // 清空表单\n      formData.password = '';\n      formData.confirmPassword = '';\n      resetFormRef.value.resetFields();\n      \n      // 3秒后自动跳转到登录页\n      setTimeout(() => {\n        router.push('/auth/login');\n      }, 3000);\n    } catch (error) {\n      console.error('重置密码错误:', error);\n      errorMessage.value = error.response?.data?.message || '重置密码失败，请稍后重试';\n    } finally {\n      loading.value = false;\n    }\n  });\n};\n</script>\n\n<style scoped>\n/* 可以添加任何特定于此页面的样式 */\n</style> "],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA,UAAM,QAAQ,SAAQ;AACtB,UAAM,SAAS,UAAS;AAExB,UAAM,WAAW,SAAS;AAAA,MACxB,UAAU;AAAA,MACV,iBAAiB;AAAA,MACjB,OAAO;AAAA,IACT,CAAC;AAGD,UAAM,mBAAmB,CAAC,MAAM,OAAO,aAAa;AAClD,UAAI,UAAU,IAAI;AAChB,iBAAS,IAAI,MAAM,OAAO,CAAC;AAAA,MAC/B,WAAa,MAAM,SAAS,GAAG;AAC3B,iBAAS,IAAI,MAAM,cAAc,CAAC;AAAA,MACtC,OAAS;AACL,YAAI,SAAS,oBAAoB,IAAI;AACnC,uBAAa,MAAM,cAAc,iBAAiB;AAAA,QACpD;AACA;MACF;AAAA,IACF;AAGA,UAAM,0BAA0B,CAAC,MAAM,OAAO,aAAa;AACzD,UAAI,UAAU,IAAI;AAChB,iBAAS,IAAI,MAAM,SAAS,CAAC;AAAA,MACjC,WAAa,UAAU,SAAS,UAAU;AACtC,iBAAS,IAAI,MAAM,WAAW,CAAC;AAAA,MACnC,OAAS;AACL;MACF;AAAA,IACF;AAEA,UAAM,YAAY;AAAA,MAChB,UAAU;AAAA,QACR,EAAE,WAAW,kBAAkB,SAAS,OAAO;AAAA,MAChD;AAAA,MACD,iBAAiB;AAAA,QACf,EAAE,WAAW,yBAAyB,SAAS,OAAO;AAAA,MACxD;AAAA,IACF;AAEA,UAAM,UAAU,IAAI,KAAK;AACzB,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,iBAAiB,IAAI,EAAE;AAC7B,UAAM,eAAe,IAAI,IAAI;AAC7B,UAAM,aAAa,IAAI,KAAK;AAE5B,cAAU,MAAM;AAEd,YAAM,QAAQ,MAAM,OAAO,SAAS,MAAM,MAAM;AAEhD,UAAI,CAAC,OAAO;AACV,qBAAa,QAAQ;AACrB;AAAA,MACF;AAEA,eAAS,QAAQ;AACjB,iBAAW,QAAQ;AAAA,IACrB,CAAC;AAED,UAAM,eAAe,MAAM;AACzB,UAAI,CAAC,WAAW,OAAO;AACrB,qBAAa,QAAQ;AACrB;AAAA,MACF;AAEA,mBAAa,MAAM,SAAS,CAAO,UAAU;;AAC3C,YAAI,CAAC;AAAO;AAEZ,gBAAQ,QAAQ;AAChB,qBAAa,QAAQ;AACrB,uBAAe,QAAQ;AAEvB,YAAI;AACF,gBAAM,WAAW,MAAM,QAAQ,cAAc,SAAS,OAAO,SAAS,QAAQ;AAC9E,yBAAe,QAAQ,SAAS,KAAK,WAAW;AAGhD,mBAAS,WAAW;AACpB,mBAAS,kBAAkB;AAC3B,uBAAa,MAAM;AAGnB,qBAAW,MAAM;AACf,mBAAO,KAAK,aAAa;AAAA,UAC1B,GAAE,GAAI;AAAA,QACR,SAAQ,OAAO;AACd,kBAAQ,MAAM,WAAW,KAAK;AAC9B,uBAAa,UAAQ,iBAAM,aAAN,mBAAgB,SAAhB,mBAAsB,YAAW;AAAA,QAC5D,UAAc;AACR,kBAAQ,QAAQ;AAAA,QAClB;AAAA,MACJ,EAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}