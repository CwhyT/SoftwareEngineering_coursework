{"version":3,"file":"Feedback-9d9804ad.js","sources":["../../src/views/admin/Feedback.vue"],"sourcesContent":["<template>\n  <div class=\"feedback-management\">\n    <el-card class=\"box-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>反馈管理</span>\n          <el-button type=\"primary\" @click=\"generateTestFeedback\">\n            <el-icon><Plus /></el-icon>生成测试数据\n          </el-button>\n        </div>\n      </template>\n\n      <!-- 筛选器 -->\n      <div class=\"filter-container\">\n        <el-select v-model=\"filterType\" placeholder=\"反馈类型\" clearable>\n          <el-option label=\"车辆问题\" value=\"scooter\" />\n          <el-option label=\"系统问题\" value=\"system\" />\n          <el-option label=\"建议\" value=\"suggestion\" />\n        </el-select>\n        <el-select v-model=\"filterStatus\" placeholder=\"处理状态\" clearable>\n          <el-option label=\"待处理\" value=\"pending\" />\n          <el-option label=\"处理中\" value=\"processing\" />\n          <el-option label=\"已完成\" value=\"completed\" />\n        </el-select>\n        <el-button type=\"primary\" @click=\"refreshData\">刷新</el-button>\n      </div>\n\n      <!-- 反馈列表 -->\n      <el-table :data=\"filteredFeedback\" style=\"width: 100%\" v-loading=\"loading\">\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"120\" />\n        <el-table-column prop=\"type\" label=\"类型\" width=\"100\">\n          <template #default=\"{ row }\">\n            <el-tag :type=\"getTypeTag(row.type)\">\n              {{ getTypeLabel(row.type) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"content\" label=\"内容\" show-overflow-tooltip />\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template #default=\"{ row }\">\n            <el-tag :type=\"getStatusTag(row.status)\">\n              {{ getStatusLabel(row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"timestamp\" label=\"提交时间\" width=\"180\">\n          <template #default=\"{ row }\">\n            {{ formatDate(row.timestamp) }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"200\" fixed=\"right\">\n          <template #default=\"{ row }\">\n            <el-button type=\"primary\" size=\"small\" @click=\"showDetail(row)\">\n              查看详情\n            </el-button>\n            <el-button \n              type=\"success\" \n              size=\"small\" \n              @click=\"showReply(row)\"\n              :disabled=\"row.status === 'completed'\"\n            >\n              回复\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 详情对话框 -->\n    <el-dialog\n      v-model=\"detailVisible\"\n      title=\"反馈详情\"\n      width=\"50%\"\n    >\n      <div v-if=\"currentFeedback\" class=\"feedback-detail\">\n        <div class=\"detail-item\">\n          <span class=\"label\">用户名：</span>\n          <span>{{ currentFeedback.username }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">反馈类型：</span>\n          <el-tag :type=\"getTypeTag(currentFeedback.type)\">\n            {{ getTypeLabel(currentFeedback.type) }}\n          </el-tag>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">处理状态：</span>\n          <el-tag :type=\"getStatusTag(currentFeedback.status)\">\n            {{ getStatusLabel(currentFeedback.status) }}\n          </el-tag>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">提交时间：</span>\n          <span>{{ formatDate(currentFeedback.timestamp) }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">反馈内容：</span>\n          <div class=\"content\">{{ currentFeedback.content }}</div>\n        </div>\n        <div v-if=\"currentFeedback.scooterId\" class=\"detail-item\">\n          <span class=\"label\">相关车辆：</span>\n          <span>{{ currentFeedback.scooterId }}</span>\n        </div>\n        <div v-if=\"currentFeedback.reply\" class=\"detail-item\">\n          <span class=\"label\">回复内容：</span>\n          <div class=\"content\">{{ currentFeedback.reply }}</div>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!-- 回复对话框 -->\n    <el-dialog\n      v-model=\"replyVisible\"\n      title=\"回复反馈\"\n      width=\"50%\"\n    >\n      <div v-if=\"currentFeedback\" class=\"reply-form\">\n        <div class=\"feedback-content\">\n          <h4>反馈内容：</h4>\n          <p>{{ currentFeedback.content }}</p>\n        </div>\n        <el-form :model=\"replyForm\" label-width=\"80px\">\n          <el-form-item label=\"回复内容\">\n            <el-input\n              v-model=\"replyForm.content\"\n              type=\"textarea\"\n              :rows=\"4\"\n              placeholder=\"请输入回复内容\"\n            />\n          </el-form-item>\n          <el-form-item label=\"处理状态\">\n            <el-select v-model=\"replyForm.status\">\n              <el-option label=\"处理中\" value=\"processing\" />\n              <el-option label=\"已完成\" value=\"completed\" />\n            </el-select>\n          </el-form-item>\n        </el-form>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"replyVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitReply\">\n            提交回复\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport { Plus } from '@element-plus/icons-vue'\n\n// 状态\nconst loading = ref(false)\nconst feedback = ref([])\nconst filterType = ref('')\nconst filterStatus = ref('')\nconst detailVisible = ref(false)\nconst replyVisible = ref(false)\nconst currentFeedback = ref(null)\nconst replyForm = ref({\n  content: '',\n  status: 'processing'\n})\n\n// 计算属性：过滤后的反馈列表\nconst filteredFeedback = computed(() => {\n  return feedback.value.filter(item => {\n    const typeMatch = !filterType.value || item.type === filterType.value\n    const statusMatch = !filterStatus.value || item.status === filterStatus.value\n    return typeMatch && statusMatch\n  })\n})\n\n// 获取反馈数据\nconst fetchFeedback = () => {\n  loading.value = true\n  try {\n    const storedFeedback = localStorage.getItem('feedback')\n    if (storedFeedback) {\n      feedback.value = JSON.parse(storedFeedback)\n    }\n  } catch (error) {\n    console.error('获取反馈数据失败:', error)\n    ElMessage.error('获取反馈数据失败')\n  } finally {\n    loading.value = false\n  }\n}\n\n// 刷新数据\nconst refreshData = () => {\n  fetchFeedback()\n}\n\n// 显示详情\nconst showDetail = (row) => {\n  currentFeedback.value = row\n  detailVisible.value = true\n}\n\n// 显示回复对话框\nconst showReply = (row) => {\n  currentFeedback.value = row\n  replyForm.value = {\n    content: '',\n    status: row.status === 'pending' ? 'processing' : row.status\n  }\n  replyVisible.value = true\n}\n\n// 提交回复\nconst submitReply = () => {\n  if (!replyForm.value.content.trim()) {\n    ElMessage.warning('请输入回复内容')\n    return\n  }\n\n  const index = feedback.value.findIndex(f => f.id === currentFeedback.value.id)\n  if (index !== -1) {\n    feedback.value[index] = {\n      ...feedback.value[index],\n      reply: replyForm.value.content,\n      status: replyForm.value.status\n    }\n    localStorage.setItem('feedback', JSON.stringify(feedback.value))\n    ElMessage.success('回复成功')\n    replyVisible.value = false\n    refreshData()\n  }\n}\n\n// 生成测试数据\nconst generateTestFeedback = () => {\n  const testFeedback = [\n    {\n      id: Date.now(),\n      type: 'scooter',\n      status: 'pending',\n      username: '测试用户1',\n      content: '车辆无法启动，请检查',\n      timestamp: new Date().toISOString(),\n      scooterId: 'SCOOTER001'\n    },\n    {\n      id: Date.now() + 1,\n      type: 'system',\n      status: 'processing',\n      username: '测试用户2',\n      content: 'APP经常闪退，影响使用',\n      timestamp: new Date().toISOString(),\n      reply: '正在排查问题，请稍候'\n    },\n    {\n      id: Date.now() + 2,\n      type: 'suggestion',\n      status: 'completed',\n      username: '测试用户3',\n      content: '建议增加更多的停车点',\n      timestamp: new Date().toISOString(),\n      reply: '感谢您的建议，我们会认真考虑'\n    }\n  ]\n\n  const existingFeedback = localStorage.getItem('feedback')\n  const allFeedback = existingFeedback \n    ? [...JSON.parse(existingFeedback), ...testFeedback]\n    : testFeedback\n\n  localStorage.setItem('feedback', JSON.stringify(allFeedback))\n  ElMessage.success('测试数据生成成功')\n  refreshData()\n}\n\n// 辅助函数\nconst getTypeTag = (type) => {\n  const types = {\n    scooter: 'danger',\n    system: 'warning',\n    suggestion: 'info'\n  }\n  return types[type] || 'info'\n}\n\nconst getTypeLabel = (type) => {\n  const labels = {\n    scooter: '车辆问题',\n    system: '系统问题',\n    suggestion: '建议'\n  }\n  return labels[type] || type\n}\n\nconst getStatusTag = (status) => {\n  const statuses = {\n    pending: 'info',\n    processing: 'warning',\n    completed: 'success'\n  }\n  return statuses[status] || 'info'\n}\n\nconst getStatusLabel = (status) => {\n  const labels = {\n    pending: '待处理',\n    processing: '处理中',\n    completed: '已完成'\n  }\n  return labels[status] || status\n}\n\nconst formatDate = (dateString) => {\n  return new Date(dateString).toLocaleString()\n}\n\n// 初始化\nonMounted(() => {\n  fetchFeedback()\n})\n</script>\n\n<style scoped>\n.feedback-management {\n  padding: 20px;\n  margin-bottom: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.filter-container {\n  margin-bottom: 20px;\n  display: flex;\n  gap: 10px;\n}\n\n.feedback-detail {\n  padding: 20px;\n}\n\n.detail-item {\n  margin-bottom: 15px;\n}\n\n.detail-item .label {\n  font-weight: bold;\n  margin-right: 10px;\n}\n\n.detail-item .content {\n  margin-top: 5px;\n  padding: 10px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n}\n\n.reply-form {\n  padding: 20px;\n}\n\n.feedback-content {\n  margin-bottom: 20px;\n  padding: 10px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n}\n\n.feedback-content h4 {\n  margin: 0 0 10px 0;\n  color: #606266;\n}\n\n.feedback-content p {\n  margin: 0;\n  color: #303133;\n}\n</style> "],"names":[],"mappings":"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"}